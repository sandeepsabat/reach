<!DOCTYPE html>
<html>
<head>
    <title>Campaign Run</title>
</head>
<body>
    <h1>Tracker Page For Sent Emails</h1>
    <p><a href="{{url_for('index')}}"> Back to Home</a></p>
    <div id="output"></div>

    <script>
        
            // add an EventSource function to initiate open a connection with server side from client
            const eventSource = new EventSource('/run/streamCampaign?cohortName={{cohortname|urlencode}}&senderEmail={{senderemail}}&emailTemplates={{emailtemplates|urlencode}}');

            //continuously read the messages sent from the server side
            eventSource.onmessage = function(event) {
                document.getElementById('output').innerText += event.data + '\n';
            };

            //add an event listener to listen to events from server. if a close event is sent then close the EventSource stream
            eventSource.addEventListener('close', function(event) {
                document.getElementById('output').innerText += event.data + '\n'
                eventSource.close();
            });
            
        

        
        
    </script>
</body>
</html>