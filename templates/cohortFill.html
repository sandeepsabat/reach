<!DOCTYPE html>
<html>
<head>
    <title>Customer Upload Tracker</title>
</head>
<body>
    <h1>Tracker Customer Upload to Cohort</h1>
    <p><a href="{{url_for('index')}}"> Back to Home</a></p>
    <div id="output"></div>

    <script>
        
            // add an EventSource function to initiate open a connection with server side from client
            
            
            const eventSource = new EventSource(`/customer/custUploadStream?cohortName={{cohortname|urlencode}}&fileName={{filename|urlencode}}&startRow={{startrow}}&endRow={{endrow}}`);

            //continuously read the messages sent from the server side
            eventSource.onmessage = function(event) {
                document.getElementById('output').innerText += event.data + '\n';
            };

            //add an event listener to listen to events from server. if a close event is sent then close the EventSource stream
            eventSource.addEventListener('close', function(event) {
                document.getElementById('output').innerText += event.data + '\n'
                eventSource.close();
            });
            
        

        
        
    </script>
</body>
</html>